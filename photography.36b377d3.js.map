{"mappings":"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","sources":["<anon>","src/photography/gallery.ts"],"sourcesContent":["var _loop = function(i) {\n    var photo = photos[i];\n    photo.addEventListener(\"click\", function() {\n        control.open(i);\n    });\n};\nvar photos = Array.from(document.querySelectorAll(\".photo-grid img\"));\nvar gallery = document.querySelector(\"#gallery\");\nvar imgCurrent = document.querySelector(\"#imgCurrent\");\nvar imgPrevious = document.querySelector(\"#imgPrevious\");\nvar imgContainerCurrent = document.querySelector(\"#imgContainerCurrent\");\nvar imgContainerPrevious = document.querySelector(\"#imgContainerPrevious\");\nvar arrowRight = document.querySelector(\"#arrowRight\");\nvar arrowLeft = document.querySelector(\"#arrowLeft\");\nvar skrim = document.querySelector(\"#skrim\");\nvar _parsePageURL = parsePageURL(), pageURL = _parsePageURL.pageURL, imageIndex = _parsePageURL.imageIndex;\nvar state = {\n    imageIndex: imageIndex\n};\nfor(var i = 0; i < photos.length; i++)_loop(i);\ndocument.addEventListener(\"keydown\", function(e) {\n    // Listeners are only for when the gallery is open\n    if (state.imageIndex === null) return;\n    switch(e.key){\n        case \"ArrowLeft\":\n            control.prev();\n            break;\n        case \"ArrowRight\":\n            control.next();\n            break;\n        case \"ArrowUp\":\n        case \"ArrowDown\":\n        case \"Escape\":\n            control.close();\n            break;\n    }\n});\narrowRight.addEventListener(\"click\", function() {\n    return control.next();\n});\narrowLeft.addEventListener(\"click\", function() {\n    return control.prev();\n});\ngallery.addEventListener(\"click\", function(e) {\n    if (e.target instanceof HTMLButtonElement) return;\n    if (arrowLeft.contains(e.target)) return;\n    if (arrowRight.contains(e.target)) return;\n    control.close();\n});\n// TODO Popstate event listener\nvar control = {\n    open: function(index) {\n        if (inRange(index)) {\n            state.imageIndex = index;\n            transition(\"up\", null, photos[index].src);\n            writeURL(index);\n        }\n    },\n    close: function() {\n        var from = state.imageIndex === null ? null : photos[state.imageIndex].src;\n        state.imageIndex = null;\n        if (from) transition(\"down\", from, null);\n        writeURL(null);\n    },\n    next: function() {\n        var from = state.imageIndex === null ? null : photos[state.imageIndex].src;\n        var to = null;\n        if (state.imageIndex !== null) {\n            state.imageIndex++;\n            if (inRange(state.imageIndex)) to = photos[state.imageIndex].src;\n            else state.imageIndex = null;\n        }\n        transition(\"left\", from, to);\n        writeURL(state.imageIndex);\n    },\n    prev: function() {\n        var from = state.imageIndex === null ? null : photos[state.imageIndex].src;\n        var to = null;\n        if (state.imageIndex !== null) {\n            state.imageIndex--;\n            if (inRange(state.imageIndex)) to = photos[state.imageIndex].src;\n            else state.imageIndex = null;\n        }\n        transition(\"right\", from, to);\n        writeURL(state.imageIndex);\n    }\n};\nvar cleanupTransition = function() {};\n// gallery renderer\nfunction transition(type, from, to) {\n    // ensure the previous transition was cleaned up\n    cleanupTransition();\n    if (to) {\n        gallery.classList.remove(\"hidden\");\n        imgCurrent.src = to;\n        imgContainerCurrent.classList.add(\"start-out\");\n        switch(type){\n            case \"up\":\n                imgContainerCurrent.classList.add(\"start-down\");\n                break;\n            case \"down\":\n                imgContainerCurrent.classList.add(\"start-up\");\n                break;\n            case \"left\":\n                imgContainerCurrent.classList.add(\"start-right\");\n                break;\n            case \"right\":\n                imgContainerCurrent.classList.add(\"start-left\");\n                break;\n        }\n    } else imgCurrent.src = \"\";\n    if (from) {\n        imgContainerPrevious.classList.remove(\"hidden\");\n        imgContainerPrevious.classList.add(\"start-in\");\n        imgPrevious.src = from;\n    } else imgPrevious.src = \"\";\n    requestAnimationFrame(function() {\n        if (to) imgContainerCurrent.classList.add(\"transition-in-center\");\n        if (from) switch(type){\n            case \"up\":\n                imgContainerPrevious.classList.add(\"transition-out-up\");\n                break;\n            case \"down\":\n                imgContainerPrevious.classList.add(\"transition-out-down\");\n                break;\n            case \"left\":\n                imgContainerPrevious.classList.add(\"transition-out-left\");\n                break;\n            case \"right\":\n                imgContainerPrevious.classList.add(\"transition-out-right\");\n                break;\n        }\n    });\n    var listeningEl = from ? imgContainerPrevious : imgContainerCurrent;\n    cleanupTransition = function() {\n        listeningEl.removeEventListener(\"transitionend\", cleanupTransition);\n        cleanupTransition = function() {};\n        removeAnimationClasses(imgContainerCurrent);\n        removeAnimationClasses(imgContainerPrevious);\n        imgContainerPrevious.classList.add(\"hidden\");\n        if (!to) gallery.classList.add(\"hidden\");\n    };\n    listeningEl.addEventListener(\"transitionend\", cleanupTransition);\n}\nfunction removeAnimationClasses(el) {\n    el.classList.remove(\"transition-out-up\", \"transition-out-down\", \"transition-out-left\", \"transition-out-right\", \"transition-in-center\", \"start-left\", \"start-right\", \"start-up\", \"start-down\", \"start-out\", \"start-in\");\n}\nwindow.addEventListener(\"load\", function() {\n    if (state.imageIndex !== null) control.open(state.imageIndex);\n});\nfunction parsePageURL() {\n    var url = \"\".concat(window.location.origin).concat(window.location.pathname);\n    var hash = window.location.hash;\n    var imageIndex = null;\n    if (hash) {\n        var num = parseInt(hash.replace(\"#\", \"\"), 10);\n        if (inRange(num - 1)) imageIndex = num - 1;\n    }\n    return {\n        pageURL: url,\n        imageIndex: imageIndex\n    };\n}\nfunction writeURL(index) {\n    var nextPageURL = pageURL;\n    if (index !== null && inRange(index)) nextPageURL += \"#\".concat(index + 1);\n    window.history.pushState(null, \"\", nextPageURL);\n}\nfunction inRange(index) {\n    return !Number.isNaN(index) && index >= 0 && index < photos.length;\n}\n\n//# sourceMappingURL=photography.36b377d3.js.map\n","const photos = Array.from(\n  document.querySelectorAll(\".photo-grid img\")\n) as HTMLImageElement[];\n\nconst gallery = document.querySelector(\"#gallery\") as HTMLDivElement;\nconst imgCurrent = document.querySelector(\"#imgCurrent\") as HTMLImageElement;\nconst imgPrevious = document.querySelector(\"#imgPrevious\") as HTMLImageElement;\nconst imgContainerCurrent = document.querySelector(\n  \"#imgContainerCurrent\"\n) as HTMLDivElement;\nconst imgContainerPrevious = document.querySelector(\n  \"#imgContainerPrevious\"\n) as HTMLDivElement;\nconst arrowRight = document.querySelector(\"#arrowRight\") as HTMLButtonElement;\nconst arrowLeft = document.querySelector(\"#arrowLeft\") as HTMLButtonElement;\nconst skrim = document.querySelector(\"#skrim\") as HTMLDivElement;\n\nconst { pageURL, imageIndex } = parsePageURL();\n\nconst state = {\n  imageIndex,\n};\n\nfor (let i = 0; i < photos.length; i++) {\n  const photo = photos[i];\n  photo.addEventListener(\"click\", () => {\n    control.open(i);\n  });\n}\n\ndocument.addEventListener(\"keydown\", (e) => {\n  // Listeners are only for when the gallery is open\n  if (state.imageIndex === null) return;\n  switch (e.key) {\n    case \"ArrowLeft\":\n      control.prev();\n      break;\n    case \"ArrowRight\":\n      control.next();\n      break;\n    case \"ArrowUp\":\n    case \"ArrowDown\":\n    case \"Escape\":\n      control.close();\n      break;\n  }\n});\n\narrowRight.addEventListener(\"click\", () => control.next());\narrowLeft.addEventListener(\"click\", () => control.prev());\ngallery.addEventListener(\"click\", (e) => {\n  if (e.target instanceof HTMLButtonElement) return;\n  if (arrowLeft.contains(e.target as Node)) return;\n  if (arrowRight.contains(e.target as Node)) return;\n  control.close();\n});\n\n// TODO Popstate event listener\n\nconst control = {\n  open: (index: number) => {\n    if (inRange(index)) {\n      state.imageIndex = index;\n      transition(\"up\", null, photos[index].src);\n      writeURL(index);\n    }\n  },\n  close: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    state.imageIndex = null;\n    if (from) {\n      transition(\"down\", from, null);\n    }\n    writeURL(null);\n  },\n  next: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    let to: string | null = null;\n    if (state.imageIndex !== null) {\n      state.imageIndex++;\n      if (inRange(state.imageIndex)) {\n        to = photos[state.imageIndex].src;\n      } else {\n        state.imageIndex = null;\n      }\n    }\n    transition(\"left\", from, to);\n    writeURL(state.imageIndex);\n  },\n  prev: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    let to: string | null = null;\n    if (state.imageIndex !== null) {\n      state.imageIndex--;\n      if (inRange(state.imageIndex)) {\n        to = photos[state.imageIndex].src;\n      } else {\n        state.imageIndex = null;\n      }\n    }\n    transition(\"right\", from, to);\n    writeURL(state.imageIndex);\n  },\n};\n\nlet cleanupTransition: () => void = () => {};\n\n// gallery renderer\nfunction transition(\n  type: \"up\" | \"down\" | \"left\" | \"right\",\n  from: string | null,\n  to: string | null\n) {\n  // ensure the previous transition was cleaned up\n  cleanupTransition();\n  if (to) {\n    gallery.classList.remove(\"hidden\");\n    imgCurrent.src = to;\n    imgContainerCurrent.classList.add(\"start-out\");\n    switch (type) {\n      case \"up\":\n        imgContainerCurrent.classList.add(\"start-down\");\n        break;\n      case \"down\":\n        imgContainerCurrent.classList.add(\"start-up\");\n        break;\n      case \"left\":\n        imgContainerCurrent.classList.add(\"start-right\");\n        break;\n      case \"right\":\n        imgContainerCurrent.classList.add(\"start-left\");\n        break;\n    }\n  } else {\n    imgCurrent.src = \"\";\n  }\n\n  if (from) {\n    imgContainerPrevious.classList.remove(\"hidden\");\n    imgContainerPrevious.classList.add(\"start-in\");\n    imgPrevious.src = from;\n  } else {\n    imgPrevious.src = \"\";\n  }\n\n  requestAnimationFrame(() => {\n    if (to) {\n      imgContainerCurrent.classList.add(\"transition-in-center\");\n    }\n    if (from) {\n      switch (type) {\n        case \"up\":\n          imgContainerPrevious.classList.add(\"transition-out-up\");\n          break;\n        case \"down\":\n          imgContainerPrevious.classList.add(\"transition-out-down\");\n          break;\n        case \"left\":\n          imgContainerPrevious.classList.add(\"transition-out-left\");\n          break;\n        case \"right\":\n          imgContainerPrevious.classList.add(\"transition-out-right\");\n          break;\n      }\n    }\n  });\n\n  const listeningEl = from ? imgContainerPrevious : imgContainerCurrent;\n  cleanupTransition = () => {\n    listeningEl.removeEventListener(\"transitionend\", cleanupTransition);\n    cleanupTransition = () => {};\n\n    removeAnimationClasses(imgContainerCurrent);\n    removeAnimationClasses(imgContainerPrevious);\n    imgContainerPrevious.classList.add(\"hidden\");\n    if (!to) {\n      gallery.classList.add(\"hidden\");\n    }\n  };\n  listeningEl.addEventListener(\"transitionend\", cleanupTransition);\n}\n\nfunction removeAnimationClasses(el: HTMLElement) {\n  el.classList.remove(\n    \"transition-out-up\",\n    \"transition-out-down\",\n    \"transition-out-left\",\n    \"transition-out-right\",\n    \"transition-in-center\",\n    \"start-left\",\n    \"start-right\",\n    \"start-up\",\n    \"start-down\",\n    \"start-out\",\n    \"start-in\"\n  );\n}\n\nwindow.addEventListener(\"load\", () => {\n  if (state.imageIndex !== null) control.open(state.imageIndex);\n});\n\nfunction parsePageURL() {\n  const url = `${window.location.origin}${window.location.pathname}`;\n  const hash = window.location.hash;\n  let imageIndex: number | null = null;\n  if (hash) {\n    const num = parseInt(hash.replace(\"#\", \"\"), 10);\n    if (inRange(num - 1)) {\n      imageIndex = num - 1;\n    }\n  }\n\n  return {\n    pageURL: url,\n    imageIndex,\n  };\n}\n\nfunction writeURL(index: number | null) {\n  let nextPageURL = pageURL;\n  if (index !== null && inRange(index)) {\n    nextPageURL += `#${index + 1}`;\n  }\n  window.history.pushState(null, \"\", nextPageURL);\n}\n\nfunction inRange(index: number) {\n  return !Number.isNaN(index) && index >= 0 && index < photos.length;\n}\n"],"names":["_loop","i","photo","photos","addEventListener","control","open","Array","from","document","querySelectorAll","gallery","querySelector","imgCurrent","imgPrevious","imgContainerCurrent","imgContainerPrevious","arrowRight","arrowLeft","_parsePageURL","parsePageURL","url","concat","window","location","origin","pathname","hash","imageIndex","num","parseInt","replace","inRange","pageURL","state","length","e","key","prev","next","close","target","HTMLButtonElement","contains","index","transition","src","writeURL","to","cleanupTransition","type","classList","remove","add","requestAnimationFrame","listeningEl","removeEventListener","removeAnimationClasses","el","nextPageURL","history","pushState","Number","isNaN"],"version":3,"file":"photography.36b377d3.js.map"}