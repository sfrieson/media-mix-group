{"mappings":"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","sources":["src/photography/gallery.ts"],"sourcesContent":["const photos = Array.from(\n  document.querySelectorAll(\".photo-grid img\")\n) as HTMLImageElement[];\n\nconst gallery = document.querySelector(\"#gallery\") as HTMLDivElement;\nconst imgCurrent = document.querySelector(\"#imgCurrent\") as HTMLImageElement;\nconst imgPrevious = document.querySelector(\"#imgPrevious\") as HTMLImageElement;\nconst imgContainerCurrent = document.querySelector(\n  \"#imgContainerCurrent\"\n) as HTMLDivElement;\nconst imgContainerPrevious = document.querySelector(\n  \"#imgContainerPrevious\"\n) as HTMLDivElement;\nconst arrowRight = document.querySelector(\"#arrowRight\") as HTMLButtonElement;\nconst arrowLeft = document.querySelector(\"#arrowLeft\") as HTMLButtonElement;\nconst skrim = document.querySelector(\"#skrim\") as HTMLDivElement;\n\nconst { pageURL, imageIndex } = parsePageURL();\n\nconst state = {\n  imageIndex,\n};\n\nfor (let i = 0; i < photos.length; i++) {\n  const photo = photos[i];\n  photo.addEventListener(\"click\", () => {\n    control.open(i);\n  });\n}\n\ndocument.addEventListener(\"keydown\", (e) => {\n  // Listeners are only for when the gallery is open\n  if (state.imageIndex === null) return;\n  switch (e.key) {\n    case \"ArrowLeft\":\n      control.prev();\n      break;\n    case \"ArrowRight\":\n      control.next();\n      break;\n    case \"ArrowUp\":\n    case \"ArrowDown\":\n    case \"Escape\":\n      control.close();\n      break;\n  }\n});\n\narrowRight.addEventListener(\"click\", () => control.next());\narrowLeft.addEventListener(\"click\", () => control.prev());\ngallery.addEventListener(\"click\", (e) => {\n  if (e.target instanceof HTMLButtonElement) return;\n  if (arrowLeft.contains(e.target as Node)) return;\n  if (arrowRight.contains(e.target as Node)) return;\n  control.close();\n});\n\n// TODO Popstate event listener\n\nconst control = {\n  open: (index: number) => {\n    if (inRange(index)) {\n      state.imageIndex = index;\n      transition(\"up\", null, photos[index].src);\n      writeURL(index);\n    }\n  },\n  close: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    state.imageIndex = null;\n    if (from) {\n      transition(\"down\", from, null);\n    }\n    writeURL(null);\n  },\n  next: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    let to: string | null = null;\n    if (state.imageIndex !== null) {\n      state.imageIndex++;\n      if (inRange(state.imageIndex)) {\n        to = photos[state.imageIndex].src;\n      } else {\n        state.imageIndex = null;\n      }\n    }\n    transition(\"left\", from, to);\n    writeURL(state.imageIndex);\n  },\n  prev: () => {\n    const from =\n      state.imageIndex === null ? null : photos[state.imageIndex].src;\n    let to: string | null = null;\n    if (state.imageIndex !== null) {\n      state.imageIndex--;\n      if (inRange(state.imageIndex)) {\n        to = photos[state.imageIndex].src;\n      } else {\n        state.imageIndex = null;\n      }\n    }\n    transition(\"right\", from, to);\n    writeURL(state.imageIndex);\n  },\n};\n\nlet cleanupTransition: () => void = () => {};\n\n// gallery renderer\nfunction transition(\n  type: \"up\" | \"down\" | \"left\" | \"right\",\n  from: string | null,\n  to: string | null\n) {\n  // ensure the previous transition was cleaned up\n  cleanupTransition();\n  if (to) {\n    gallery.classList.remove(\"hidden\");\n    imgCurrent.src = to;\n    imgContainerCurrent.classList.add(\"start-out\");\n    switch (type) {\n      case \"up\":\n        imgContainerCurrent.classList.add(\"start-down\");\n        break;\n      case \"down\":\n        imgContainerCurrent.classList.add(\"start-up\");\n        break;\n      case \"left\":\n        imgContainerCurrent.classList.add(\"start-right\");\n        break;\n      case \"right\":\n        imgContainerCurrent.classList.add(\"start-left\");\n        break;\n    }\n  } else {\n    imgCurrent.src = \"\";\n  }\n\n  if (from) {\n    imgContainerPrevious.classList.remove(\"hidden\");\n    imgContainerPrevious.classList.add(\"start-in\");\n    imgPrevious.src = from;\n  } else {\n    imgPrevious.src = \"\";\n  }\n\n  requestAnimationFrame(() => {\n    if (to) {\n      imgContainerCurrent.classList.add(\"transition-in-center\");\n    }\n    if (from) {\n      switch (type) {\n        case \"up\":\n          imgContainerPrevious.classList.add(\"transition-out-up\");\n          break;\n        case \"down\":\n          imgContainerPrevious.classList.add(\"transition-out-down\");\n          break;\n        case \"left\":\n          imgContainerPrevious.classList.add(\"transition-out-left\");\n          break;\n        case \"right\":\n          imgContainerPrevious.classList.add(\"transition-out-right\");\n          break;\n      }\n    }\n  });\n\n  const listeningEl = from ? imgContainerPrevious : imgContainerCurrent;\n  cleanupTransition = () => {\n    listeningEl.removeEventListener(\"transitionend\", cleanupTransition);\n    cleanupTransition = () => {};\n\n    removeAnimationClasses(imgContainerCurrent);\n    removeAnimationClasses(imgContainerPrevious);\n    imgContainerPrevious.classList.add(\"hidden\");\n    if (!to) {\n      gallery.classList.add(\"hidden\");\n    }\n  };\n  listeningEl.addEventListener(\"transitionend\", cleanupTransition);\n}\n\nfunction removeAnimationClasses(el: HTMLElement) {\n  el.classList.remove(\n    \"transition-out-up\",\n    \"transition-out-down\",\n    \"transition-out-left\",\n    \"transition-out-right\",\n    \"transition-in-center\",\n    \"start-left\",\n    \"start-right\",\n    \"start-up\",\n    \"start-down\",\n    \"start-out\",\n    \"start-in\"\n  );\n}\n\nwindow.addEventListener(\"load\", () => {\n  if (state.imageIndex !== null) control.open(state.imageIndex);\n});\n\nfunction parsePageURL() {\n  const url = `${window.location.origin}${window.location.pathname}`;\n  const hash = window.location.hash;\n  let imageIndex: number | null = null;\n  if (hash) {\n    const num = parseInt(hash.replace(\"#\", \"\"), 10);\n    if (inRange(num - 1)) {\n      imageIndex = num - 1;\n    }\n  }\n\n  return {\n    pageURL: url,\n    imageIndex,\n  };\n}\n\nfunction writeURL(index: number | null) {\n  let nextPageURL = pageURL;\n  if (index !== null && inRange(index)) {\n    nextPageURL += `#${index + 1}`;\n  }\n  window.history.pushState(null, \"\", nextPageURL);\n}\n\nfunction inRange(index: number) {\n  return !Number.isNaN(index) && index >= 0 && index < photos.length;\n}\n"],"names":[],"version":3,"file":"photography.aad43fac.js.map","sourceRoot":"/__parcel_source_root/"}